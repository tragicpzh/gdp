<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>AdminLTE 2 | Data Tables</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" th:href="@{/Rendering/plugins/bootstraptable/bootstrap.css}">
    <!-- Font Awesome -->
    <link rel="stylesheet" th:href="@{/Rendering/plugins/fontawesome-free/css/fontawesome.min.css}">
    <!-- Ionicons -->
    <link rel="stylesheet" th:href="@{/Rendering/plugins/Ionicons/css/ionicons.min.css}">
    <!-- DataTables -->
    <link rel="stylesheet" th:href="@{/Rendering/plugins/datatables.net-bs/css/dataTables.bootstrap.min.css}">
    <!-- Theme style -->
    <link rel="stylesheet" th:href="@{/Rendering/dist/css/adminlte.min.css}">
    <link th:href="@{/Rendering/plugins/skins/_all-skins.min.css}" rel="stylesheet">

</head>
<body>
<div class="wrapper">
    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Main content -->
        <section class="content">
            <div class="box">
                <div class="box-header">
                    <h3 class="box-title">课题列表</h3>
                </div>
                        <!-- /.box-header -->
                <div>
                    <b>课题名称：</b><input type="text" id="subject_name" class="abc input-default">
                    <b>开题老师：</b><input type="text" id="subject_teacher" class="abc input-default">
                    <b>所属专业:</b><input type="text" id="subject_major" class="abc input-default">
                    <b>课题编号：</b><input type="text" id="subject_id" class="abc input-default">
                    <b>所属方向：</b><input type="text" id="subject_direction" class="abc input-default">
                    <b>难度系数：</b><input type="text" id="difficult_min" class="abc input-default">
                                <b>-</b>
                                <b><input type="text" id="difficult_max" class="abc input-default"></b>
                    <button type="button" onclick="reloadTable()" class="btn btn-primary">查询</button>
                </div>
                <div class="box-body">
                    <table id="Subject_table" class="table table-bordered table-hover">
                    </table>
                </div>
                        <!-- /.box-body -->
            </div>
                    <!-- /.box -->
        </section>
        <!-- /.content -->
    </div>
</div>
<!-- ./wrapper -->

<script th:src="@{/Rendering/plugins/jquery/jquery.min.js}"></script>
<!-- Bootstrap -->
<script th:src="@{/Rendering/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
<!-- AdminLTE -->
<script th:src="@{/Rendering/dist/js/adminlte.js}"></script>

<!-- OPTIONAL SCRIPTS -->
<script th:src="@{/Rendering/plugins/chart.js/Chart.min.js}"></script>
<script th:src="@{/Rendering/dist/js/demo.js}"></script>
<script th:src="@{/Rendering/dist/js/pages/dashboard3.js}"></script>
<script th:src="@{/Rendering/plugins/layer/layer.js}"></script>

<!--bootstrap table-->
<script th:src="@{/Rendering/plugins/bootstrap/js/bootstrap.js}"></script>
<script th:src="@{/Rendering/plugins/bootstraptable/bootstrap-table.js}"></script>
<script th:src="@{/Rendering/plugins/bootstraptable/locale/bootstrap-table-zh-CN.js}"></script>
<!-- page script -->
<script>

    $(function () {
        window.operateEvents={
        'click .btn_choose':function(e,value,row,index){
            var id=row.id;
            layer.confirm("确认选择"+row.name+" ?",{icon: 3,title:'选择课题'},function (index) {
                $.ajax({
                    type:"update",
                    url:"/subject/choose",
                    contentType:"application/json",
                    data:JSON.stringify({"id":id}),
                    success:function (msg) {
                        layer.msg("操作成功",{time:700});
                    }
                });
                layer.close(index);
            });
        },
        'click .btn_check':function (e,value,row,index) {
            var id=row.id;
            layer.open({
                type:2,
                title:'课题信息',
                area:['800px','500px'],
                shade:[0.3,'#393D49'],
                content:"/student/listSubject/subject_more?subject_id="+id
            });
        }
        };
        $('#Subject_table').bootstrapTable('destroy').bootstrapTable({
            method: 'get',
            url: "/subject/list",
            striped: true,
            dataField: "list",
            totalField: "total",
            pageNumber: 1,
            pageSize: 10,
            pagination: true,
            queryParamsType: 'limit',
            // search: true,
            queryParams: function (params) {
                return {
                    subject_name:$('#subject_name').val(),
                    subject_teacher:$('#subject_teacher').val(),
                    subject_major:$('#subject_major').val(),
                    subject_id:$('#subject_id').val(),
                    subject_direction:$('#subject_direction').val(),
                    difficult_min:$('#difficult_min').val(),
                    difficult_max:$('#difficult_max').val(),
                    pageSize: params.limit,
                    pageNo: params.offset / params.limit + 1
                }
            },
            sidePagination: 'server',
            pageList: "[10, 25, 50, 100, all]",
            showRefresh: false,
            clickToSelect: true,
            toolbarAlign: 'left',
            buttonsAlign: 'right',
            toolbar: '#toolbar',
            showColumns: false,
            paginationLoop: false,
            columns: [
                {
                    title: 'ID',
                    field: 'id',
                    visible: false,
                    width: 50
                },
                {
                    title: '课题名称',
                    field: 'name',
                    visible: true,
                    width: 80
                },
                {
                    title: '方向',
                    field: 'direction',
                    width: 80,
                    align: 'left'
                },
                {
                    title: '技术',
                    field: 'technology',
                    width: 80,
                    align: 'left'
                },
                {
                    title: '难度',
                    field: 'difficulty',
                    width: 80,
                    align: 'left'
                },
                {
                    title: '操作',
                    width: 80,
                    align: 'center',
                    formatter:function (value, row, index) {
                        return [
                            '<button  type="button" class="btn btn-danger btn-xs btn_check">',
                            '查看' ,
                            '</button>',
                            ' <button  type="button" class="btn btn-primary btn-xs btn_choose">',
                            '选择' ,
                            '</button>',
                        ].join('')
                    },
                    events:window.operateEvents
                }

            ],
            locale: 'zh-CN',
            responseHandler: function (data) {
                return data['data'];
            }
        });
    })
    function reloadTable() {
        $('#Subject_table').bootstrapTable('refresh');
    }

</script>
</body>
</html>
